
# ๐ ูพุฑูฺฉุณ DoH ูพุดุฑูุชู ุจุง ูพูู ูุฏุฑุช ฺฉุงููฺฏ V2Ray

ฺฉ ุณุฑูุณโุฏููุฏู (Worker) ูุฏุฑุชููุฏ ู ุงูู ุจุฑุง Cloudflare ฺฉู ุฏุฑุฎูุงุณุชโูุง DNS ุดูุง ุฑุง ุฑูุฒูฺฏุงุฑ ฺฉุฑุฏู ู ุจุง ฺฉ ูพูู ูุฏุฑุช ุฒุจุง ู ฺฉุงุฑุจุฑุฏุ ุงูฺฉุงู ุชููุฏ ฺฉุงููฺฏโูุง ูุฎุชูู ุจุฑุง ฺฉูุงูุชโูุง V2Ray ุฑุง ูุฑุงูู ูโฺฉูุฏ.

<div align="center">

[![ุชุนุฏุงุฏ ุณุชุงุฑูโูุง](https://img.shields.io/github/stars/sinaha81/dns?style=for-the-badge&logo=github)](https://github.com/sinaha81/dns/stargazers)
[![ููุฑฺฉโูุง](https://img.shields.io/github/forks/sinaha81/dns?style=for-the-badge&logo=github)](https://github.com/sinaha81/dns/network/members)
[![ูพูุชูุฑู](https://img.shields.io/badge/Platform-Cloudflare%20Workers-orange?style=for-the-badge&logo=cloudflare)](https://workers.cloudflare.com/)

</div>

## ๐ ุชูุถุญุงุช

ุงู ูพุฑูฺู ฺฉ ูพุฑูฺฉุณ DoH (DNS over HTTPS) ุงุณุช ฺฉู ุจุฑ ุฑู ุฒุฑุณุงุฎุช ุจุฏูู ุณุฑูุฑ (Serverless) ฺฉูุงุฏููุฑ ุงุฌุฑุง ูโุดูุฏ. ุงู ุณุฑูุณ ูู ุชููุง ุฏุฑุฎูุงุณุชโูุง DNS ุดูุง ุฑุง ุจุฑุง ุงูุฒุงุด ุญุฑู ุฎุตูุต ู ุงููุช ุฑูุฒูฺฏุงุฑ ูโฺฉูุฏุ ุจูฺฉู ฺฉ **ูพูู ูุฏุฑุช ุชุญุช ูุจ** ุฏุฑ ุงุฎุชุงุฑ ุดูุง ูุฑุงุฑ ูโุฏูุฏ ฺฉู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉุงููฺฏโูุง ูพุดุฑูุชู ู ุจููู ุจุฑุง ฺฉูุงูุชโูุง V2Ray (ูุงููุฏ v2rayNG ู Nekoray) ุชููุฏ ูโฺฉูุฏ. ุงู ูพูู ุจู ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ูพุงุฑุงูุชุฑูุง ูุฎุชูู ูุงููุฏ **Server Name**ุ **ALPN** ู **TLS Fingerprint** ุฑุง ุจู ุตูุฑุช ูพูุง ุชูุธู ฺฉุฑุฏู ู ฺฉุงููฺฏโูุง ูุฎุชูู (ุจุง ู ุจุฏูู Fragment) ุฑุง ุจู ุฑุงุญุช ฺฉูพ ู ุงุณุชูุงุฏู ฺฉูุฏ.

## โจ ูฺฺฏโูุง

-   ๐ **ุฑูุฒูฺฏุงุฑ ฺฉุงูู DNS**: ุชูุงู ุฏุฑุฎูุงุณุชโูุง DNS ุดูุง ุงุฒ ุทุฑู HTTPS ุฑูุฒูฺฏุงุฑ ุดุฏู ู ุงุฒ ุดููุฏ (sniffing) ุฏุฑ ุงูุงู ูโูุงููุฏ.
-   โก **ุงูุชุฎุงุจ ููุดููุฏ DNS ุณุฑูุฑ**: ุจู ุตูุฑุช ููุดููุฏ ู ุจุฑ ุงุณุงุณ ูุฒูโุฏูุ ฺฉ ุงุฒ ุจูุชุฑู ุณุฑูุณโุฏููุฏฺฏุงู DNS ุนููู (ูุงููุฏ Cloudflare, Google, Quad9) ุฑุง ุจุฑุง ูพุงุณุฎฺฏู ุงูุชุฎุงุจ ูโฺฉูุฏ.
-   โ๏ธ **ูพูู ูุฏุฑุช ูพุดุฑูุชู ุชุญุช ูุจ**:
    -   ุชููุฏ ุขู ุณู ููุน ฺฉุงููฺฏ V2Ray: **Fix Fragment**, **Best Fragment** (ูพุดุฑูุชู) ู **No Fragment**.
    -   ูุงุจูุช ุชูุธู ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ูุงููุฏ **Server Name (SNI)**ุ **ALPN** ู **TLS Fingerprint** ุจู ุตูุฑุช ูพูุง.
    -   ุฑุงุจุท ฺฉุงุฑุจุฑ ุฒุจุง ู ฺฉุงุฑุจุฑูพุณูุฏ ุจุง ุงููุงู ุงุฒ ุทุฑุงุญ GitHub.
    -   ฺฉูพ ฺฉุฑุฏู ุขุณุงู ุขุฏุฑุณ ุณุฑูุณ ู ฺฉุงููฺฏโูุง ุชููุง ุจุง ฺฉ ฺฉูฺฉ.
-   ๐ก๏ธ **ุงููุช ุจุงูุง**:
    -   **Rate Limiting**: ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุญููุงุช (ฑฐฐ ุฏุฑุฎูุงุณุช ุฏุฑ ูุฑ ุฏููู).
    -   **ูุฏุฑูุง ุงููุช**: ุงุณุชูุงุฏู ุงุฒ ูุฏุฑูุง ุงููุช ุงุณุชุงูุฏุงุฑุฏ ูุงููุฏ `Strict-Transport-Security` ู `Content-Security-Policy`.
    -   **Fallback ุฎูุฏฺฉุงุฑ**: ุฏุฑ ุตูุฑุช ุนุฏู ูพุงุณุฎฺฏู ฺฉ ุณุฑูุฑ DNSุ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุณุฑุงุบ ุณุฑูุฑ ุจุนุฏ ูโุฑูุฏ.
-   ๐ **ุงุณุชูุฑุงุฑ ุขุณุงู ู ุฑุงฺฏุงู**: ุจู ุฑุงุญุช ู ุฏุฑ ฺฉูุชุฑ ุงุฒ ฺูุฏ ุฏููู ุจุฑ ุฑู ูพูู ุฑุงฺฏุงู Cloudflare Workers ูุงุจู ูพุงุฏูโุณุงุฒ ุงุณุช.

## ๐ ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ุณุฑุน

### ูุฑุญูู ฑ: ุงุฌุงุฏ ฺฉ Worker ุฏุฑ Cloudflare

1.  ุจู ุฏุงุดุจูุฑุฏ [Cloudflare](https://dash.cloudflare.com) ูุงุฑุฏ ุดูุฏ.
2.  ุงุฒ ููู ุณูุช ฺูพุ ุจู ุจุฎุด **Workers & Pages** ุจุฑูุฏ.
3.  ุฑู **Create Application** ู ุณูพุณ **Create Worker** ฺฉูฺฉ ฺฉูุฏ.
4.  ฺฉ ูุงู ููุญุตุฑ ุจู ูุฑุฏ ุจุฑุง Worker ุฎูุฏ ุงูุชุฎุงุจ ฺฉูุฏ (ุจุฑุง ูุซุงู: `my-doh-proxy`).
5.  ุฑู ุฏฺฉูู **Deploy** ฺฉูฺฉ ฺฉูุฏ.

### ูุฑุญูู ฒ: ูุฑุงุฑ ุฏุงุฏู ฺฉุฏ ุฏุฑ Worker

1.  ูพุณ ุงุฒ ุณุงุฎุช Workerุ ุฑู ุฏฺฉูู **Edit code** ฺฉูฺฉ ฺฉูุฏ.
2.  ุชูุงู ฺฉุฏูุง ููุฌูุฏ ุฏุฑ ูุฑุงุดฺฏุฑ ุฑุง ูพุงฺฉ ฺฉูุฏ.
3.  ูุญุชูุง [ุงู ูุงู](https://github.com/sinaha81/dns/blob/main/worker.js) ุฑุง ุจู ุทูุฑ ฺฉุงูู ฺฉูพ ฺฉุฑุฏู ู ุฏุฑ ูุฑุงุดฺฏุฑ ุฌุงโฺฏุฐุงุฑ ฺฉูุฏ.
4.  ุฏุฑ ููุงุชุ ุฑู **Save and Deploy** ฺฉูฺฉ ฺฉูุฏ.

### ูุฑุญูู ณ: ุงุณุชูุงุฏู ุงุฒ ูพูู ูุฏุฑุช

ุงฺฉููู ุณุฑูุณ ุดูุง ุขูุงุฏู ุงุณุช. ุจุง ูุฑุงุฌุนู ุจู ุขุฏุฑุณ Worker ุฎูุฏุ ูพูู ูุฏุฑุช ุฑุง ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏ:
`https://my-doh-proxy.your-subdomain.workers.dev`

## ๐ฑ ูุญูู ุงุณุชูุงุฏู

### ฑ. ฺฉูุงูุชโูุง V2Ray (ูพุดููุงุฏ)

ูพุณ ุงุฒ ุฑุงูโุงูุฏุงุฒุ ุจู ุขุฏุฑุณ ุงุตู Worker ุฎูุฏ ุจุฑูุฏ ุชุง ูพูู ูุฏุฑุช ุฑุง ุจุจูุฏ. ุฏุฑ ุงู ูพูู ูโุชูุงูุฏ:

-   **ูพุงุฑุงูุชุฑูุง ุนููู ุฑุง ุชูุธู ฺฉูุฏ**:
    -   **ูุณุช Server Name**: ุฏุงูููโูุง ููุฑุฏ ูุธุฑ ุฎูุฏ ุฑุง ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ SNI ูุงุฑุฏ ฺฉูุฏ.
    -   **ALPN**: ูพุฑูุชฺฉู ูุงู ุจุฑูุงูู ููุฑุฏ ูุธุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
    -   **TLS Fingerprint**: ุงุซุฑ ุงูฺฏุดุช TLS ุฑุง ุจุฑุง ุดุจูโุณุงุฒ ุชุฑุงูฺฉ ูุฑูุฑฺฏุฑูุง ูุฎุชูู ุชูุธู ฺฉูุฏ.
-   **ฺฉุงููฺฏ ููุฑุฏ ูุธุฑ ุฑุง ฺฉูพ ฺฉูุฏ**:
    -   **Fix Fragment**: ฺฉ ฺฉุงููฺฏ ุงุณุชุงูุฏุงุฑุฏ ุจุง ุชูุธูุงุช Fragment ุซุงุจุช.
    -   **Best Fragment (ูพุดุฑูุชู)**: ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจูุชุฑู ุญุงูุช Fragment ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ.
    -   **No Fragment**: ุจุฑุง ุดุจฺฉูโูุง ฺฉู ูุงุฒ ุจู ุชฺฉูโุชฺฉู ฺฉุฑุฏู ุจุณุชูโูุง ูุฏุงุฑูุฏ.

ฺฉุงููฺฏ ฺฉูพ ุดุฏู ุฑุง ูุณุชููุงู ุฏุฑ ฺฉูุงูุช V2Ray ุฎูุฏ (ูุงููุฏ v2rayNG) ุงุฒ ุทุฑู ฺฏุฒูู **Import config from Clipboard** ูุงุฑุฏ ฺฉูุฏ.

### ฒ. ุณุงุฑ ุฏุณุชฺฏุงูโูุง ู ุจุฑูุงููโูุง

ุขุฏุฑุณ DoH ุฎูุฏ ุฑุง ุงุฒ ูพูู ูุฏุฑุช ฺฉูพ ฺฉูุฏ. ูุฑูุช ุขู ุจู ุดฺฉู ุฒุฑ ุงุณุช:
```
https://your-worker-name.your-subdomain.workers.dev/dns-query
```
ุณูพุณ ุงุฒ ุงู ุขุฏุฑุณ ุฏุฑ ุจุฑูุงููโูุง ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:

#### ูุฑูุฑฺฏุฑ Chrome / Edge / Brave
```
Settings โ Privacy and security โ Security โ Use secure DNS โ Custom
```

#### ูุฑูุฑฺฏุฑ Firefox
```
Settings โ Privacy & Security โ DNS over HTTPS โ Custom
```

#### ุงูพูฺฉุดู Intra (ุงูุฏุฑูุฏ)
1.  ุงูพูฺฉุดู [Intra](https://play.google.com/store/apps/details?id=app.intra) ุฑุง ูุตุจ ู ุจุงุฒ ฺฉูุฏ.
2.  ุงุฒ ููู ุจุงูุง ุณูุช ฺูพุ ูุงุฑุฏ **Settings** ุดูุฏ.
3.  ฺฏุฒูู **Select DNS over HTTPS Server** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.
4.  **Custom server URL** ุฑุง ุงูุชุฎุงุจ ฺฉุฑุฏู ู ุขุฏุฑุณ DoH ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ.
5.  ุจู ุตูุญู ุงุตู ุจุฑฺฏุดุชู ู ุณุฑูุณ ุฑุง ูุนุงู ฺฉูุฏ.

## ๐ ุณุฑูุฑูุง DNS ุงุณุชูุงุฏู ุดุฏู

ุงู ูพุฑูฺฉุณ ุจู ุตูุฑุช ูพุดโูุฑุถ ุงุฒ ูุฌููุนูโุง ุงุฒ ุจูุชุฑู ู ุณุฑุนโุชุฑู ุณุฑูุณโุฏููุฏฺฏุงู DNS ุนููู ุงุณุชูุงุฏู ูโฺฉูุฏ:

| ูุงู ุณุฑูุณ    | ุฏุณุชูโุจูุฏ            | ุชูุถุญุงุช                                                    |
| :----------- | :-------------------- | :--------------------------------------------------------- |
| **Cloudflare** | ุนููู ู ุณุฑุน          | ุชูุฑฺฉุฒ ุจุฑ ุณุฑุนุช ู ุญุฑู ุฎุตูุตุ ุจุฏูู ุฐุฎุฑู ูุงฺฏ.                |
| **Google**     | ุนููู ู ุณุฑุน          | ูพุงุฏุงุฑ ู ุณุฑุนุช ุจุงูุง ุฏุฑ ุณุฑุงุณุฑ ุฌูุงู.                         |
| **Quad9**      | ุนููู ู ุณุฑุน          | ูุณุฏูุฏุณุงุฒ ุฏุงูููโูุง ูุฎุฑุจุ ูุดูฺฏ ู ุจุฏุงูุฒุงุฑูุง.              |
| **OpenDNS**    | ุนููู ู ุณุฑุน          | ฺฉ ุงุฒ ูุฏูโุชุฑู ู ูพุงุฏุงุฑุชุฑู ุณุฑูุณโูุง DNS.              |
| **DNS4EU**     | ุนููู ู ุณุฑุน          | ุณุฑูุณ DNS ุงุฑููพุง ุจุง ุชูุฑฺฉุฒ ุจุฑ ุญุฑู ุฎุตูุต.                  |
| **AdGuard**    | ูุณุฏูุฏฺฉููุฏู ุชุจูุบุงุช   | ูุณุฏูุฏุณุงุฒ ููุซุฑ ุชุจูุบุงุชุ ุฑุฏุงุจโูุง ู ุณุงุชโูุง ูุฎุฑุจ.         |

## โ๏ธ ุชูุธูุงุช ูพุดุฑูุชู

ุดูุง ูโุชูุงูุฏ ฺฉุฏ ุฑุง ุจู ุณุงุฏฺฏ ุจุฑุง ูุงุฒูุง ุฎูุฏ ุดุฎุตโุณุงุฒ ฺฉูุฏ.

### ุชุบุฑ ูุณุช ุณุฑูุฑูุง DNS

ุจุฑุง ุชุบุฑุ ุงูุฒูุฏู ุง ุญุฐู ุณุฑูุฑูุง DNSุ ุขุฑุงู `UPSTREAM_DNS_PROVIDERS` ุฑุง ุฏุฑ ุงุจุชุฏุง ฺฉุฏ ูุฑุงุด ฺฉูุฏ. ูโุชูุงูุฏ `weight` ูุฑ ุณุฑูุฑ ุฑุง ูุฒ ุจุฑุง ุชุบุฑ ุงุญุชูุงู ุงูุชุฎุงุจ ุขูุ ุชูุธู ฺฉูุฏ.

```javascript
const UPSTREAM_DNS_PROVIDERS = [
  { name: "Cloudflare", url: "https://cloudflare-dns.com/dns-query", weight: 25, /* ... */ },
  { name: "Google", url: "https://dns.google/dns-query", weight: 20, /* ... */ },
  // ... ุณุงุฑ ุณุฑูุณโุฏููุฏูโูุง
];
```

### ุชุบุฑ ูุญุฏูุฏุชโูุง

ูโุชูุงูุฏ ููุงุฏุฑ ูุฑุจูุท ุจู ูุญุฏูุฏุช ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชุ ุฒูุงู ุงููุถุง ฺฉุด ู ุญุฏุงฺฉุซุฑ ุฒูุงู ุงูุชุธุงุฑ ุจุฑุง ูพุงุณุฎ ุฑุง ุชุบุฑ ุฏูุฏ.

```javascript
const DNS_CACHE_TTL = 300; // ุฒูุงู ุงููุถุง ฺฉุด DNS (ุจู ุซุงูู)
const REQUEST_TIMEOUT = 10000; // ุญุฏุงฺฉุซุฑ ุฒูุงู ุงูุชุธุงุฑ ุจุฑุง ูพุงุณุฎ (ุจู ููโุซุงูู)
const RATE_LIMIT_REQUESTS = 100; // ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ูุฌุงุฒ
const RATE_LIMIT_WINDOW = 60000; // ุฏุฑ ุจุงุฒู ุฒูุงู (ุจู ููโุซุงูู)
```

## โ๏ธ ูฺฉุงุช ููู

-   ุงู ุณุฑูุณ **ููุท ุฏุฑุฎูุงุณุชโูุง DNS** ุฑุง ุฑูุฒูฺฏุงุฑ ูโฺฉูุฏ ู ุจู ุชููุง ุงุจุฒุงุฑ ุจุฑุง ุนุจูุฑ ุงุฒ ููุชุฑูฺฏ ูุณุช.
-   ฺฉุงููฺฏโูุง V2Ray ุชููุฏ ุดุฏู ุจุฑุง ุงููโุณุงุฒ ู ุจูููโุณุงุฒ ุงุชุตุงู ุดูุง ุทุฑุงุญ ุดุฏูโุงูุฏ ู ุชุฑุงูฺฉ ุดูุง ุฑุง ุงุฒ ุณุฑูุฑูุง ุฏฺฏุฑ ุนุจูุฑ ููโุฏููุฏ.

## ๐ค ูุดุงุฑฺฉุช

ุงุฒ ูุฑฺฏููู ูุดุงุฑฺฉุช ุฏุฑ ุงู ูพุฑูฺู ุงุณุชูุจุงู ูโุดูุฏ. ุงฺฏุฑ ูพุดููุงุฏ ุง ูุดฺฉู ุฏุงุฑุฏุ ูุทูุงู ฺฉ **Issue** ุฌุฏุฏ ุซุจุช ฺฉูุฏ ุง ฺฉ **Pull Request** ุงุฑุณุงู ููุงุฏ.

---

<p align="center">
  โญ ุงฺฏุฑ ุงู ูพุฑูฺู ุจุฑุง ุดูุง ููุฏ ุจูุฏุ ูุทูุงู ุจุง ุณุชุงุฑู ุฏุงุฏู ุจู ุขู ุงุฒ ูุง ุญูุงุช ฺฉูุฏ! โญ
</p>
